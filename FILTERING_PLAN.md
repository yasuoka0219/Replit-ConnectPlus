# 検索・フィルタリング機能強化プラン

## 📊 現状の実装

### 案件一覧
- ✅ 検索: 案件名、企業名
- ✅ フィルタ: ステージ、ステータス、担当者

### 企業一覧
- ✅ 検索: 企業名、業種、所在地

### 連絡先一覧
- ✅ 検索: 名前、メール、企業名

---

## 🎯 追加すべき機能（優先順位順）

### 🔴 最優先（Phase 1）

#### 1. **案件一覧の高度なフィルタリング**
**実装内容:**
- **金額範囲フィルタ**: 最小金額〜最大金額で絞り込み
- **温度感スコアフィルタ**: A/B/C/ネタで絞り込み
- **期間フィルタ**: 
  - 作成日範囲（開始日〜終了日）
  - 最終更新日範囲
  - 計上月（受注案件のみ）
- **複数条件の組み合わせ**: AND条件で複数フィルタを同時適用

**UI改善:**
- フィルタパネルを展開/折りたたみ可能に
- 適用中のフィルタをタグ表示
- 「フィルタをクリア」ボタン

**実装難易度**: ⭐⭐⭐（中）

---

#### 2. **企業一覧の高度なフィルタリング**
**実装内容:**
- **業界フィルタ**: 15業界から選択
- **温度感スコアフィルタ**: 1-5段階
- **最終接触日フィルタ**: 
  - 30日以内
  - 60日以内
  - 90日以内
  - 90日以上（長期未接触）
- **タグフィルタ**: タグで絞り込み
- **従業員数範囲**: 最小〜最大

**UI改善:**
- フィルタパネルを追加
- 複数条件の組み合わせ

**実装難易度**: ⭐⭐（中）

---

#### 3. **ソート機能の追加**
**実装内容:**
- **案件一覧**:
  - 作成日（新着順/古い順）
  - 更新日（新着順/古い順）
  - 金額（高い順/低い順）
  - ステージ滞留日数（長い順/短い順）
  - 案件名（あいうえお順）
- **企業一覧**:
  - 企業名（あいうえお順）
  - 最終接触日（新しい順/古い順）
  - 温度感スコア（高い順/低い順）
  - 案件数（多い順/少ない順）
- **連絡先一覧**:
  - 名前（あいうえお順）
  - 企業名（あいうえお順）

**UI改善:**
- ソート選択ドロップダウン
- 現在のソート条件を表示

**実装難易度**: ⭐⭐（中）

---

### 🟡 高優先度（Phase 2）

#### 4. **保存済み検索条件**
**実装内容:**
- よく使う検索条件を保存
- 保存した検索条件に名前を付ける
- ワンクリックで適用
- 保存済み検索の一覧表示・削除

**実装難易度**: ⭐⭐⭐⭐（高）
- データベースに保存する必要があるため、新しいテーブルが必要

---

#### 5. **高度な検索UI（検索バーの拡張）**
**実装内容:**
- **検索演算子のサポート**:
  - `"完全一致"` - 完全一致検索
  - `-除外` - 除外検索
  - `OR` - OR検索
- **フィールド指定検索**:
  - `案件名:キーワード`
  - `企業名:キーワード`
  - `担当者:名前`
- **検索履歴**: 最近の検索キーワードを表示

**実装難易度**: ⭐⭐⭐（中）

---

#### 6. **一括操作機能**
**実装内容:**
- フィルタ結果の一括選択
- 一括ステータス変更
- 一括担当者変更
- 一括削除（確認付き）

**実装難易度**: ⭐⭐⭐（中）

---

### 🟢 中優先度（Phase 3）

#### 7. **ページネーションの改善**
**実装内容:**
- 現在は全件表示だが、大量データ対応
- ページネーション（1ページあたり10/25/50/100件）
- 無限スクロール（オプション）

**実装難易度**: ⭐⭐（中）

---

#### 8. **検索結果のエクスポート**
**実装内容:**
- フィルタ結果をCSV/Excelでエクスポート
- 現在の検索条件を保持したままエクスポート

**実装難易度**: ⭐⭐（中）

---

## 📝 実装の詳細仕様

### 案件一覧の高度なフィルタリング例

```python
# フィルタパラメータ例
{
    'search': 'キーワード',
    'stage': '提案',
    'status': 'OPEN',
    'assignee_id': 1,
    'heat_score': 'A',
    'amount_min': 100000,
    'amount_max': 1000000,
    'created_from': '2025-01-01',
    'created_to': '2025-12-31',
    'revenue_month': '2025-11',
    'sort_by': 'amount',
    'sort_order': 'desc'
}
```

### UIイメージ

```
┌─────────────────────────────────────────────────┐
│ [検索バー]                    [フィルタ ▼] [ソート ▼] │
├─────────────────────────────────────────────────┤
│ フィルタパネル（展開時）                          │
│ ┌───────────────────────────────────────────┐ │
│ │ ステージ: [全ステージ ▼]                    │ │
│ │ ステータス: [進行中 ▼]                      │ │
│ │ 担当者: [全担当者 ▼]                        │ │
│ │ 温度感: [A ▼]                               │ │
│ │ 金額: [最小] 〜 [最大]                       │ │
│ │ 期間: [開始日] 〜 [終了日]                   │ │
│ │ [適用] [クリア]                             │ │
│ └───────────────────────────────────────────┘ │
└─────────────────────────────────────────────────┘
```

---

## 🚀 実装開始の推奨順序

### 第1段階（すぐに実装）
1. **案件一覧の高度なフィルタリング**
   - 金額範囲
   - 温度感スコア
   - 期間フィルタ

2. **ソート機能の追加**
   - 各一覧画面にソート機能

### 第2段階
3. **企業一覧の高度なフィルタリング**
4. **検索UIの改善**

### 第3段階
5. **保存済み検索条件**
6. **一括操作機能**

---

## 💡 実装のポイント

1. **段階的実装**: 一度に全部実装せず、1つずつ確実に
2. **後方互換性**: 既存の検索・フィルタ機能は維持
3. **パフォーマンス**: インデックスを活用した高速検索
4. **ユーザビリティ**: 直感的で使いやすいUI

---

どの機能から実装を始めますか？













