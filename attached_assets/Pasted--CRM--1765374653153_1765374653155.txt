あなたは、既存のCRMアプリのダッシュボードを改善するデータエンジニア兼フロントエンドエンジニアです。

目的：
営業効率と精度を高めるために、既存のダッシュボードを「クロス集計中心」に再設計してください。単純な件数・売上の集計だけでなく、以下のクロス集計をわかりやすいカード・グラフ・テーブルとして配置してください。

前提：
- Company / Deal / Activity などのモデルがあり、以下のような項目が存在している前提です：
  - Company：industry, company_size, area, customer_status など
  - Deal：amount, gross_profit, lead_source, stage, new_or_existing, probability_rank, lost_reason, competitor_name, first_contact_date, proposal_date, won_date, lost_date など
  - Activity：type, date, duration_minutes, count, related_company_id, related_deal_id など
- 既存のダッシュボードコンポーネントを流用しつつ、新しいカード・グラフを追加してください。
- 参照元テーブルとカラムを間違えないように、必ずモデル定義を確認しながら実装してください。

ダッシュボード構成要件：

1. 上部：全体KPIサマリー（単純集計）
   - 今月の売上合計（Deal.amount の won_date が今月のもの）
   - 今月の新規受注件数（new_or_existing = 新規 & won）
   - 今月の受注率（今月クローズした案件のうち won の割合）
   - 今月の新規リード数（初回接触日 first_contact_date が今月の案件件数）
   - これらはカード形式で表示し、期間フィルタ（当月 / 前月 / 直近3ヶ月など）に連動させる。

2. クロス集計①：リードソース × 成果
   - 表：行＝リードソース（lead_source）、列＝
     - リード数
     - アポ率（first_contact_dateが設定された案件 / リード数）
     - 受注率（won件数 / 案件数）
     - 平均単価（平均 amount）
     - 平均LTV（Company単位で累計受注額を算出し、その平均）
   - この表にソート機能を付与し、「受注率が高い順」「平均単価が高い順」で並べ替えられるようにする。

3. クロス集計②：業界 × 受注率・売上
   - 行＝業界（Company.industry）
   - 列＝
     - 案件数
     - 受注率
     - 売上合計
     - 平均単価
     - 平均リードタイム（日数）：first_contact_date 〜 won_date の平均
   - 業界別の棒グラフ（売上合計）と、業界別受注率の折れ線グラフを一緒に表示しても良い。

4. クロス集計③：担当者 × 活動量 × 受注率
   - 行＝担当者
   - 列＝
     - 活動件数合計（Activity.count の合計）
     - 商談数（案件数）
     - 受注件数
     - 受注率
     - 売上合計
   - 活動量と受注率の関係を散布図などで視覚化しても良い（x軸：活動件数、y軸：受注率）。

5. クロス集計④：ステージ別ファネル
   - ステージ（Deal.stage）ごとに
     - 案件数
     - 金額合計
     - ステージ遷移率（前ステージからの割合）
     - 平均滞在日数（そのステージに滞在している平均日数）
   - ファネル図または横棒グラフで、「リード → アポ → ヒアリング → 提案 → 受注」の数と金額が一目でわかるようにする。

6. クロス集計⑤：失注理由 × 業界 / 担当者
   - モード切り替え可能なテーブルを作る：
     - モード1：行＝失注理由（lost_reason）、列＝案件数・金額・主な業界トップ3
     - モード2：行＝担当者、列＝失注理由別の件数
   - どの失注理由が多いのか、どの担当者がどの失注理由に偏っているかがわかるようにする。

7. クロス集計⑥：期間別推移
   - 月別の推移グラフ：
     - 売上
     - 新規顧客数（customer_statusが新規になった企業数）
     - 受注率
   - 月次の折れ線グラフ・棒グラフを組み合わせて表示し、期間フィルタ（直近6ヶ月 / 12ヶ月など）で切り替え可能にする。

8. フィルタ機能
   - ダッシュボード全体の上部に共通フィルタを配置：
     - 期間（開始日〜終了日、またはプリセット期間）
     - 担当者
     - 業界
     - リードソース
   - フィルタは全てのチャート・テーブルに共通で適用されるように実装する（必要ならバックエンド側で共通クエリロジックを作る）。

9. UI/UXの注意点
   - 各カード・チャート・テーブルには、わかりやすい日本語タイトルと簡単な説明文（サブタイトル）をつける。
     - 例：「リードソース別 受注率・単価」「業界別 受注率＆売上」「担当者別 活動量と成果」など。
   - 1画面に詰め込みすぎないように、セクション単位でブロックを分け、スクロールしながら見られるレイアウトにする。
   - 表やグラフの凡例、軸ラベルを丁寧につけて、何を見ているのか一目で分かるようにする。
   - モバイル表示時には、カード → テーブル → グラフの順で縦に並ぶようにし、横スクロールが必要なテーブルはヘッダーを固定する。

10. 実装上の注意
   - データ集計ロジックはバックエンド側に共通のサービス層やクエリ関数として切り出し、同じクエリを複数箇所で重複実装しない。
   - null や日付の欠損があっても落ちないように、防御的に実装する（例：分母が0のときは「-」表示にするなど）。
   - 既存のダッシュボードコンポーネントとの互換性を保ちつつ、新しいコンポーネントを追加する形で実装する。

以上の要件に基づき、既存コードベースを読み込みながら、ダッシュボードを「クロス集計中心」の構成に安全に改修してください。